apiVersion: operator.victoriametrics.com/v1beta1
kind: VMPodScrape
metadata:
  name: cloudflare-tunnel
  namespace: monitoring
spec:
  jobLabel: app.kubernetes.io/instance
  namespaceSelector:
    matchNames:
    - cloudflare-tunnel
  podMetricsEndpoints:
  - port: metrics
    scheme: http
    path: /metrics
    relabelConfigs:
    - action: labelmap
      regex: "__meta_kubernetes_pod_node_name"
      replacement: "node_name"
  selector:
    matchExpressions:
    - key: app.kubernetes.io/name
      operator: In
      values:
      - cloudflare-tunnel
